<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>System Prompt Bookmarklet Generator</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 800px;
      margin: 2rem auto;
      padding: 1rem;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 1.5rem;
    }
    textarea, input {
      width: 100%;
      padding: 0.75rem;
      font-family: monospace;
      margin-top: 0.5rem;
    }
    button {
      margin-top: 2rem;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      cursor: pointer;
    }
    code, .output {
      display: block;
      white-space: pre-wrap;
      word-break: break-word;
      background: #f0f0f0;
      padding: 1rem;
      margin-top: 1rem;
      border: 1px solid #ccc;
    }
    .bookmarklet-link {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: #007bff;
      color: white;
      text-decoration: none;
      border-radius: 4px;
    }
    details summary {
      cursor: pointer;
      font-weight: bold;
      margin-top: 2rem;
    }
    pre {
      background: #f9f9f9;
      border-left: 4px solid #007bff;
      padding: 1rem;
      overflow-x: auto;
    }
  </style>
</head>
<body>

  <h1 style="color: red;">DISCLAIMER</h1>
  <p style="color: red;">NOTE: BOOKMARKLETS CAN BE USED TO STEAL YOUR DATA. DO NOT TRUST RANDOM BOOKMARKLETS.</p>
  <p>
    I created this tool because I value an easy way for me to save my proxy settings and switch between various system prompts automatically...
    <br><br>
    You can copy the contents of this webpage into ChatGPT and say "Is this safe? Can I trust this, is there anything malicious about this website?"...
  </p>

  <h1 style="color: black;">Janitor AI pre-saved proxy settings</h1>
  <p>This webpage creates a Bookmarklet...</p>

  <p>> <a href="https://github.com/Bimaadizi/bookmarklet/blob/main/index.html">CLICK HERE TO VIEW HTML CODE.</a></p>

  <label for="prompt">System Prompt (The text box the code targets changes with updates. If it isn't working contact me @harles_harleson on discord)</label>
  <textarea id="prompt" placeholder="Paste your system prompt here..." rows="12"></textarea>

  <label for="model">Model Name (If you want to switch between models)</label>
  <input id="model" placeholder="e.g. deepseek-ai/DeepSeek-V3-0324" />

  <label for="proxyUrl">Proxy URL (If your URL for another proxy is somewhere else)</label>
  <input id="proxyUrl" placeholder="e.g. https://llm.chutes.ai/v1/chat/completions" />

  <label for="proxyKey">Proxy Key (If you're switching from one service to another, there's nothing malicious about this code but read the disclaimer and be careful when entering your API key somewhere.)</label>
  <input id="proxyKey" placeholder="Paste proxy key here" />

  <button onclick="generateBookmarklet()">Generate Bookmarklet</button>

  <div id="outputContainer" style="display:none;">
    <h2>Your Custom Bookmarklet</h2>
    <code id="bookmarkletCode"></code>
    <a id="bookmarkletLink" class="bookmarklet-link" href="#" target="_blank">üîñ Drag Me to Bookmarks!</a>
  </div>

  <details>
    <summary>üîç Show Code Explanation (Click to expand)</summary>
    <pre><code>
// Bookmarklet only updates fields that have values
(function(){
  function setReactInputValue(el, value) {
    const lastValue = el.value;
    el.focus();
    el.value = value;
    const tracker = el._valueTracker;
    if (tracker) tracker.setValue(lastValue);
    el.dispatchEvent(new Event("input", { bubbles: true }));
    el.blur();
  }

  const p = "<<< YOUR CUSTOM PROMPT >>>";
  const c = {
    "model": "<<< MODEL IF PROVIDED >>>",
    "https://url.com/v1": "<<< PROXY URL >>>",
    "Some reverse proxy key, do not put OpenAI API key here": "<<< PROXY KEY >>>"
  };

  let changes = 0;

  if (p.trim()) {
    const t = document.querySelector(".css-1ki54i textarea");
    if (t) {
      setReactInputValue(t, p);
      changes++;
    }
  }

  document.querySelectorAll(".chakra-input").forEach(i => {
    const h = i.getAttribute("placeholder");
    if (c[h] && c[h].trim()) {
      setReactInputValue(i, c[h]);
      changes++;
    }
  });

  if (changes > 0) {
    alert("‚úÖ Prompt and config fields injected successfully. Save your changes and refresh the page.");
  } else {
    alert("‚ö†Ô∏è No changes made ‚Äî all fields were left blank.");
  }
})();
    </code></pre>
  </details>

  <script>
    function escapeJS(str) {
      return str
        .replace(/\\/g, "\\\\")
        .replace(/`/g, "\\`")
        .replace(/\$/g, "\\$")
        .replace(/\n/g, "\\n");
    }

    function generateBookmarklet() {
      const promptRaw = document.getElementById("prompt").value.trim();
      const model = document.getElementById("model").value.trim();
      const proxyUrl = document.getElementById("proxyUrl").value.trim();
      const proxyKey = document.getElementById("proxyKey").value.trim();

      const prompt = escapeJS(promptRaw);
      let config = {};
      if (model) config["model"] = model;
      if (proxyUrl) config["https://url.com/v1"] = proxyUrl;
      if (proxyKey) config["Some reverse proxy key, do not put OpenAI API key here"] = proxyKey;

      const configStr = JSON.stringify(config).replace(/"/g, '\\"');

      const bookmarklet = `javascript:(function(){
        function setReactInputValue(el,v){
          const l=el.value;
          el.focus();
          el.value=v;
          const t=el._valueTracker;
          if(t)t.setValue(l);
          el.dispatchEvent(new Event("input",{bubbles:!0}));
          el.blur();
        }
        const p=\`${prompt}\`;
        const c=${JSON.stringify(config)};
        let changes=0;
        if(p.trim()){
          const t=document.querySelector(".css-1ki54i textarea");
          if(t){setReactInputValue(t,p);changes++;}
        }
        document.querySelectorAll(".chakra-input").forEach(i=>{
          const h=i.getAttribute("placeholder");
          if(c[h]&&c[h].trim()){
            setReactInputValue(i,c[h]);
            changes++;
          }
        });
        if(changes>0){
          alert("‚úÖ Prompt and config fields injected successfully. Save your changes and refresh the page.");
        }else{
          alert("‚ö†Ô∏è No changes made ‚Äî all fields were left blank.");
        }
      })();`;

      document.getElementById("bookmarkletCode").textContent = bookmarklet;
      document.getElementById("bookmarkletLink").href = bookmarklet;
      document.getElementById("outputContainer").style.display = "block";
    }
  </script>
</body>
</html>
